	<!DOCTYPE HTML>

<html>
	<head>
		<title>Portfolio Artur Skrzeta</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Header -->
			<section id="header">
				<header>
					<span class="image avatar"><a href="https://arturskrzeta.github.io/"><img src="images/avatar.png" alt="" style="margin-bottom:0px"/></a></span>
					<h1 id="logo"><a href="https://arturskrzeta.github.io/">Artur Skrzeta</a></h1>
					<p>Data Analyst<br />
					+4 years experience</p>
				</header>
				<nav id="nav">
					<ul>
						<li><a href="#one" class="active">Intro</a></li>
						<li><a href="#two">Features</a></li>
						<li><a href="#three">Demo</a></li>
						<li><a href="#four">Setup</a></li>
						<li><a href="#five">Source Code</a></li>
					</ul>
				</nav>
				<footer>
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/artur-skrz%C4%99ta-010b23187/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
						<li><a href="https://www.instagram.com/arturskrrr/" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="https://github.com/ArturSkrzeta" class="icon brands fa-github"><span class="label">Github</span></a></li>
						<li><a href="mailto: arturskrzeta@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li
					</ul>
				</footer>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

						<!-- One -->
							<section id="one">
								<div class="container">
									<header class="major">

										<h2>OLAP in Snowflake</h2>
										<h3>Intro</h3>
										<p style="text-align: justify">Snowflake is the platform delivered as a service which means we don't have to worry about patches, upgrades or maintenance.
										I like the way they describe it: <i>combines the power of data warehousing, the flexibility of big data platforms, and the elasticity of the cloud</i>.</p>

										<h5>Navigate to AWS aspects:</h5>
										<ul>
											<li><a href="#snowflake_architecture">Snowflake architecture</a></li>
											<li><a href="#snowflake_pipeline">Snowflake pipeline</a></li>
											<li><a href="#snowflake_objects">Snowflake objects</a></li>
											<li><a href="#olap">Online Analytical Processing</a></li>
											<li><a href="#snowflake_workflow">Snowflake workflow</a></li>
											<li><a href="#sql_scripting">Sql scripting</a></li>
											<li><a href="#data_load">Data load</a></li>
											<li><a href="#snow_sql">SnowSQL</a></li>
											<li><a href="#snow_pipe">SnowPipe</a></li>
										</ul>

										<!-- <h5>6. Continuous monitoring:</h5>
										<ul>
											<li>...</li>
											firewall configures some security rules. Accepting connection from trusted network and blocking connection from untrusted network.
										</ul> -->

									</header>
								</div>
							</section>

						<!-- Two -->
							<section id="two">
								<div class="container">
									<h3>Features</h3>
									<p>App includes following features:</p>
									<ul class="feature-icons">
										<li class="icon solid fa-check">Snowflake</li>
									</ul>
								</div>
							</section>

						<!-- Three -->
							<section id="three">
								<div class="container">
									<h3>Demo</h3>
									<h5 id="snowflake_architecture">Snowflake architecture</h5>
									<ul>
										<li>In Snowflake's architecture, the key is a separation of storage, compute and services:
											<br><br>
											<img src="images/snowflake_architecture.png" width="640"><span style="font-size:12px">soruce: snowflake</span>
											<br>
											- S3 as a storage layer (Google Cloud Storage or Azure Blob Storage),<br>
											- EC2 Virtual Warehouse as a compute layer .<br>
											- metadata, security, transactions and concurrency management as service layer.
										</li>
										<li id="snowflake_pipeline">Building pipelines with Snowflake:
											<br><br>
											<img src="images/snowflake_pipeline.JPG">
											<span style="font-size:12px">soruce: snowflake</span>
										</li>
										<li id="snowflake_objects">Snowflake objects:
												<br>
												- Database - containing schemas, tables, views, stages, file formats, sequences. All the tables are created in PUBLIC schema by default.<br>
												- Stage - a data lake like place from which data files are being copied into the tables.<br>
												- File format - we need to define format of the files bieng stored at stage.<br>
												- Warehouse - computing enginge.<br>
												- Worksheet - a place where we can proceed with writing or loading ready SQL scripts.<br>
										</li>
									</ul>

									<h5>Snowflake mechanism:</h5>
									<ul>
										<li id="olap">Snowflake for OLAP:
											<br>
											- snowflake supports <b>Online Analytical Processing (OLAP)</b> for scanning all of the data in columns in order to get aggregated values as opposed to <b>Online Transactional Processing (OLTP)</b> where we want to retrieve one or many rows from database.
												The main purpose of OLAP is data analysis and when it comes to OLTP then main purpose is data processing (inserting, updating).
											<br><br>
											<img src="images/olap.JPG" style="border: 1px solid gray;" width="420"><span style="font-size:12px">soruce: Data Council</span>
											<br>
											- while a classic databases like PostgreSQL or MySQL are type of <b>raw store</b> (OLTP) that keeps data linearly row by row, from left to right, from top to bottom, Snowflake supports <b>columnar store</b> (OLAP) which allows to traverse entire columns one by one.
											<br><br>
											<img src="images/columnstore.JPG" style="border: 1px solid gray;" width="640"><span style="font-size:12px">soruce: Data Council</span>
											<br>
											- using columnar storage makes sense when we want to analyze one or two specific columns and skip reading other ones.
										</li>
										<li id="snowflake_workflow">Snowflake workflow:
											<br>
											- Dividing big tabular data into x-consecutive rows segments called micropartitions.<br>
											- Reorganizing the data of each micropartition by flipping row store into columnar - column values of each row get stored together.<br>
											- Adding a header to each micropartition. Header contains metadata of given micropartition and columns it contains.<br>
											- Micropartitions are being stored in S3 as the immutable files.<br>
											- All the information about micropartitions are being stored in Sknowflake's metadata layer.<br>
											- When query comes in, metadata layer knows which micropartition in S3 belongs to the queried table.<br>
											- Reading a S3 file, it searches for a specific header first and then reads the only column we specified in the query.<br>
											- It reads the only queried data ingnoring the rest of S3 files.
										</li>
										<li id="sql_scripting">Every action on db can be performed with sql script along with setting up stages, file formats,
												configuring warehouse, copying data to a table from a stage.
												<br><br>
												<img src="images/sql_script.JPG">
												<br>
												<img src="images/sql_script2.JPG">
										</li>
										<li id="data_load">Data Loading consists of two parts:
											<br>
											1. Staging the files into the place where Snowflake can retrieve data files from. We can have both internal and exteranl (S3, GSP) storages.<br>
											2. Loding the data into a specific table.
										</li>
									</ul>

									<h5id="snow_sql">SnowSQL</h5>
									<ul>
										<li>The command line interface client for connecting to Snowflake.</li>
										<li>Allows to execute SQL queries to perform DDL and DML operations</li>
										<li>We can install it from Snowflake UI and there is info on how to connect at the end:
											<br><br>
											<img src="images/snowsql_installation.JPG">
											<br>
										<li>Example:
											<br>
											<code>USE DATABASE my_db;</code><br>
											<code>CREATE OR REPLACE TABLE my_tbl {</code><br>&nbsp&nbsp&nbsp&nbsp
												<code>...</code><br>
											<code>};</code><br>
											<code>CREATE STAGE csvfiles;</code><br>
											<code>PUT file:///tmp/load/abc*.csv @csvfiles;</code><br>
											<code>LIST @csvfiles;</code><br>
											<code>CREATE WAREHOUSE IF NOT EXISTS "dataload" WAREHOUSE.SIZE = "Large"</code><br>&nbsp&nbsp&nbsp&nbsp
												<code>AUTOSUSPEND = 300 AUTO_RESUME = TRUE;</code><br>
											<code>USE WAREHUSE dataload;</code><br>
											<code>COPY INTO my_tbl</code><br>&nbsp&nbsp&nbsp&nbsp
												<code>FROM @csvfiles</code><br>&nbsp&nbsp&nbsp&nbsp
												<code>PATTERN = '.*file0[1-4].csv.gz'</code><br>&nbsp&nbsp&nbsp&nbsp
												<code>ON_ERROR = 'skip_file';</code><br>
											<code>SELECT * FROM my_tbl LIMIT 10;</code>
										</li>
										<li>We can learn a lot from the documentation:
												<u><a href="https://docs.snowflake.com/en/">Snowflake documentation</a></u>
										</li>
									</ul>

									<h5 id="snow_pipe">SnowPipe:</h5>
									<ul>
										<li>It loads data from a sources like AWS S3 bucket into a certain target table.</li>
										<li>With SnowPipe we can perform whole ETL process:
<!-- start -->
<pre>
<span style="color:#00ff45">CREATE PIPE</span> my_pipe
<span style="color:#00ff45">AUTO_INGEST</span> = FALSE
<span style="color:#00ff45">AS</span>
<span style="color:#00ff45">COPY INTO</span> "MY_DB"."MY_STAGE"."tbl_my_table" (col1, col2, col3, col4, col5, col6, col7, col8)
  <span style="color:#00ff45">FROM</span> (
    <span style="color:#00ff45">SELECT</span>
      <span style="color:#00ffea">substr</span>(stage_alias.$3, 1, 7),
      <span style="color:#00ffea">iff</span>(stage_alias.$1 = 100, replace(stage_alias, '100', 'Done'), 'In progress'),
      stage_alias.$2,
      stage_alias.$3,
      <span style="color:#00ffea">replace</span>(stage_alias.$5, ',', '.'),
      'Artur',
      metadata$filename,
      <span style="color:#00ffea">CURRENT_TIMESTAMP</span>()
    <span style="color:#00ff45">FROM</span>
      @"MY_DB"."MY_STAGE"."s3_bucket_name" stage_alias
    )
<span style="color:#00ff45">FILE FORMAT</span> = (format_name = "MY_DB"."MY_STAGE"."SAP_X")
<span style="color:#00ff45">FORCE</span> = FALSE;
</pre>
<!-- end -->
											- at first, we create a pipe name and assign it to the COPY INTO,<br>
											- each pipe definition starts with COPY INTO then we state a destination table according to the path:<br>
											<code>database</code>.<code>stage</code>.<code>destination table</code>,<br>
											then we list all the destination columns that we want to feed with the data load.<br>
											- In SELECT statement, we perform entire data manipulation where each line corresponds to a signle column listed in the COPY INTO line,<br>
											- In SELECT statement, we work with indexes which refer to column number in the data source,<br>
											- In SELECT statement, we can jump over an index if we want to avoid some columns or we can manipulate the data source columns sequence,<br>
											- In SELECT statement, we can either use source column (original or transformed) or we can give a hard-coded value there,<br>
											- Using metadata$filename or CURRENT_TIMESTAMP(),<br>
											- with FILE FORMAT we tell Snowflake what is the structure of the data source, what is the delimiter there etc,<br>
											- with FORCE equal to FALSE we tell Snowflake not to import the file agian if it was imported before.

										</li>
									</ul>

									<!-- <h5>Message Broker:</h5>
									<ul>
										<li></li>
									</ul>-->

								</div>
							</section>

						<!-- Four -->
							<section id="four">
								<div class="container">
									<h3>Setup</h3>

									<h5>Following installation required:</h5>
									<ul>
										<li><a href="https://signup.snowflake.com/">Snowflake page.</a></li>
									</ul>

								</div>
							</section>

							<section id="five">
								<div class="container">
									<h3>Source Code</h3>
									<p>You can view the source code: <a href="#">HERE</a></p>
									<p>&nbsp</p>
								</div>
							</section>

					</div>

				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<a href="https://arturskrzeta.github.io/" style="padding-bottom:10px;">Back to Portfolio</a>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
